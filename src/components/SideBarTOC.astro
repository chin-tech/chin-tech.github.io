---
import TableOfContents from './TableOfContents.astro';

interface Props {
  headings: any[];
  difficulty?: string;
}

const { headings, difficulty } = Astro.props;

// Optional: Match the trigger bar color to the difficulty hue
const difficultyColors: Record<string, string> = {
  Easy: "bg-success",
  Medium: "bg-warning",
  Hard: "bg-error",
  Insane: "bg-primary shadow-[0_0_10px_rgba(var(--p),0.5)]",
};

const barColor = difficulty ? difficultyColors[difficulty] : "bg-primary";
---

<aside class="fixed left-0 top-1/4 z-50 hidden sm:block">
  <div class="relative">
    {/* Trigger zone (ONLY the sliver, plus a tiny buffer) */}
    <div class="peer w-4 h-24"></div>

    {/* The visible sliver */}
    <div class:list={[
      "absolute left-0 top-0 w-1.5 h-20 rounded-r-full shadow-lg",
      barColor
    ]}></div>

    {/* Panel: opens when trigger OR panel is hovered */}
    <div
      class="
        absolute left-0 top-0 ml-0
        -translate-x-[95%]
        peer-hover:translate-x-0 hover:translate-x-0
        transition-transform duration-500
        bg-base-200/90 backdrop-blur-md
        p-6 rounded-r-2xl border-y border-r border-base-300 shadow-2xl w-72
      "
    >
      <h2 class="text-[10px] font-bold uppercase tracking-widest text-primary mb-4 opacity-70 flex items-center gap-2">
        <span class="w-2 h-2 rounded-full bg-primary animate-pulse"></span>
        On this page
      </h2>

      <div class="max-h-[60vh] overflow-y-auto pr-2 custom-scrollbar">
        <TableOfContents headings={headings} />
      </div>
    </div>
  </div>
</aside>
